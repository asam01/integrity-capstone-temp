(this.webpackJsonptoohak=this.webpackJsonptoohak||[]).push([[0],{71:function(e,t,n){e.exports=n(88)},88:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),c=n.n(o),s=n(16),i=n(17),u=n(19),l=n(18),m=n(45),d=n(24),p=n(12),h=n(5),f=n.n(h),v=n(9),b=n(15),g=n(29),y=n.n(g),E=(n(59),n(60),y.a.initializeApp({apiKey:"AIzaSyArVyBRB-XMiStAmjP5mCV2v2PmScbEpi8",authDomain:"integrity-step-capstone.firebaseapp.com",databaseURL:"https://integrity-step-capstone.firebaseio.com",projectId:"integrity-step-capstone",storageBucket:"integrity-step-capstone.appspot.com",messagingSenderId:"359578935158",appId:"1:359578935158:web:89d46122b0609b4a95a457",measurementId:"G-GMNRGZQ858"})),k=y.a.auth(),w=(y.a.firestore(),y.a.firestore()),x=(new y.a.auth.GoogleAuthProvider,function(){var e=Object(v.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t);case 2:return n=e.sent,e.abrupt("return",n.dates.length);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),j=function(){var e=Object(v.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t);case 2:return n=e.sent,e.abrupt("return",n.starting_money);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(v.a)(f.a.mark((function e(t,n){var a,r,o,c,s,i,u,l,m;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(t);case 2:return a=e.sent,e.next=5,N();case 5:return r=e.sent.length,o=q(t),c=o.collection("users").doc(),s=c.id,i=Array.from(Array(r),(function(){return 0})),e.next=12,j(t);case 12:for(u=e.sent,l={userId:s,nickname:n,net_worth:u,money_left:u,curShares:i},c.set(l),m=0;m<a;m++)c.collection("investments").doc(m).set({change:i});return e.abrupt("return",s);case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),I=function(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e4,o=w.collection("Rooms").doc();o.set({day_index:0,phase:"no-host",password:a,starting_money:r});var c=o.id;return G(null,null,e).then((function(e){S(e,t).then((function(t){o.update({symbols:e,dates:t.dates}),C(e,c,t.period,t.dates)}))})),c};var S=function(){var e=Object(v.a)(f.a.mark((function e(t,n){var a,r,o,c,s,i,u,l,m,d,p,h,v,b;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.collection("Ticker-Info").doc("Stock").collection("Stocks").where("Symbol","in",t).get();case 2:for(a=e.sent,r=0,o=new Date,c=o.getFullYear(),a.forEach((function(e){r<e.data().IPOyear&&(r=e.data().IPOyear)})),3,s=c-(r+1),i=Math.floor((12*s-3)/n),u=Math.floor(Math.random()*(i-3)+3),l=new Date(r+1,1,1),m=new Date(r+1,1+u,1),f=l,g=m,d=new Date(+f+Math.random()*(g-f)),p=[],h=d,v=0;v<n;v++)p.push(h.toISOString().substring(0,10)),h=new Date(h.setMonth(h.getMonth()+u));return b={dates:p,period:u},e.abrupt("return",b);case 19:case"end":return e.stop()}var f,g}),e)})));return function(t,n){return e.apply(this,arguments)}}(),G=function(){var e=Object(v.a)(f.a.mark((function e(t,n,a){var r,o,c,s,i,u,l,m,d,p,h,v,b;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null===n||null===t){e.next=24;break}return(o=new FormData).append("Industry",t),o.append("Sector",n),o.append("NumOfSymbols",a),e.prev=6,e.next=9,fetch("http://localhost:8080/get-symbols",{method:"POST",mode:"cors",body:o});case 9:return c=e.sent,e.next=12,c.json();case 12:if(!(s=e.sent).hasOwnProperty("Error")){e.next=16;break}return console.log("No Symbols for your query"),e.abrupt("return",r);case 16:r=s.symbols,e.next=22;break;case 19:e.prev=19,e.t0=e.catch(6),console.log("Error with Query: "+e.t0);case 22:e.next=57;break;case 24:if(null===t){e.next=36;break}return e.next=27,w.collection("Ticker-Info").doc("Industry").get();case 27:return i=e.sent,u=i.data().Industry[t],l=Math.floor(Math.random()*(u-a)+a),e.next=32,w.collection("Ticker-Info").doc("Stock").collection("Stocks").where("Industry","==",t).where("IndustryPos","<=",l).orderBy("IndustryPos").limit(a).get();case 32:e.sent.forEach((function(e){r.push(e.data().Symbol)})),e.next=57;break;case 36:if(null===n){e.next=48;break}return e.next=39,w.collection("Ticker-Info").doc("Sector").get();case 39:return m=e.sent,d=m.data().Sector[n],p=Math.floor(Math.random()*(d-a)+a),e.next=44,w.collection("Ticker-Info").doc("Stock").collection("Stocks").where("Sector","==",n).where("SectorPos","<=",p).orderBy("SectorPos").limit(a).get();case 44:e.sent.forEach((function(e){r.push(e.data().Symbol)})),e.next=57;break;case 48:return e.next=50,w.collection("Ticker-Info").doc("Stock").get();case 50:return h=e.sent,v=h.data().NumOfStocks-1,b=Math.floor(Math.random()*(v-a)+a),e.next=55,w.collection("Ticker-Info").doc("Stock").collection("Stocks").where("RandomPos",">=",b).orderBy("RandomPos").limit(a).get();case 55:e.sent.forEach((function(e){r.push(e.data().Symbol)}));case 57:return e.abrupt("return",r);case 58:case"end":return e.stop()}}),e,null,[[6,19]])})));return function(t,n,a){return e.apply(this,arguments)}}(),C=function(){var e=Object(v.a)(f.a.mark((function e(t,n,a,r){var o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new FormData).append("symbol",JSON.stringify(t)),o.append("RoomId",n),o.append("end-date",JSON.stringify(r)),e.prev=4,e.next=7,fetch("http://localhost:8080/get-prices",{method:"POST",mode:"cors",body:o});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),console.log("Error is "+e.t0);case 12:return o.append("periodLen",a),e.prev=13,e.next=16,fetch("http://localhost:8080/get-stock-image",{method:"POST",mode:"cors",body:o});case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(13),console.log("Error is "+e.t1);case 21:case"end":return e.stop()}}),e,null,[[4,9],[13,18]])})));return function(t,n,a,r){return e.apply(this,arguments)}}(),N=function(){var e=Object(v.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t);case 2:return n=e.sent,e.abrupt("return",n.symbols);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.collection("Rooms").doc(t).get().data();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(e){return w.collection("Rooms").doc(e)};var M=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={pagetype:"not-created",gameId:""},a.createGameWrapper=a.createGameWrapper.bind(Object(b.a)(a)),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){}},{key:"createGameWrapper",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(2,3,null,"");case 2:t=e.sent,this.setState({pagetype:"created",gameId:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;console.log("render called");var t=this.state,n=t.pagetype,a=t.gameId;return console.log(n),console.log(a),r.a.createElement("div",{className:"app-page create-page"},"not-created"===n&&r.a.createElement("button",{onClick:Object(v.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createGameWrapper();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))}," Create Game! "),"created"===n&&r.a.createElement("div",null,r.a.createElement("span",null,"Created game PIN: ")," ",r.a.createElement("span",{className:"dynamic-text"},a)," ",r.a.createElement(d.b,{to:"/host"},"Copy this ID and use it host the game")))}}]),n}(a.Component),R=n(36),D=n(118),L=n(119),U=n(120),_=(a.Component,function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).handleChangeSelect=function(e){a.setState(Object(R.a)({},e.target.name,e.target.value))},a.handleChange=function(e){return function(t){a.setState(Object(R.a)({},e,t.target.value))}},a.state={phase:"not-joined",questionNum:0,roomId:null,password:"",authenticated:"no",listening:"no",users:[]},a.userExists=a.userExists.bind(Object(b.a)(a)),a.updateUsers=a.updateUsers.bind(Object(b.a)(a)),a.joinGame=a.joinGame.bind(Object(b.a)(a)),a.updatePhase=a.updatePhase.bind(Object(b.a)(a)),a.initGameListener=a.initGameListener.bind(Object(b.a)(a)),a.restartGame=a.restartGame.bind(Object(b.a)(a)),a.quitGame=a.quitGame.bind(Object(b.a)(a)),a.endGame=a.endGame.bind(Object(b.a)(a)),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.state.roomId}},{key:"componentDidChange",value:function(){}},{key:"userExists",value:function(e){var t=this.state.users;return console.log("type of users: "+typeof t),Array.from(t).forEach((function(t,n){if(console.log("item ID"+t.id),console.log("checked user ID"+e),t.userId==e)return!0})),!1}},{key:"updatePhase",value:function(e){var t=this.state.roomId;this.setState({phase:e}),w.collection("Rooms").doc(t).update({phase:e})}},{key:"restartGame",value:function(){}},{key:"quitGame",value:function(){this.props.toggleHeader;this.updateGame({phase:null})}},{key:"endGame",value:function(){this.updateGame({phase:"final_result"})}},{key:"updateUsers",value:function(){var e=this.state,t=(e.password,e.roomId),n=this;w.collection("Rooms").doc(t).collection("users").get().then((function(e){e.docs.forEach((function(e){if(!n.userExists(e.id)){console.log("adding new user"),console.log("user id is "+e.id);var t=e.data();n.setState({users:n.state.users.concat([t])})}}))}))}},{key:"joinGame",value:function(){var e=this.state,t=e.password,n=e.roomId,a=this,r=w.collection("Rooms").doc(n);r.get().then((function(e){if(e.exists){var o=e.data();o.password===t&&"no-host"===o.phase?(a.setState({authenticated:"yes",phase:"connection"}),O(n,"dummy user"),a.updateUsers(),a.initGameListener(),r.update({phase:"connection"})):console.log("wrong password")}else console.log("room "+n+" does not exist")}))}},{key:"initGameListener",value:function(){var e=this.state.roomId,t=w.collection("Rooms").doc(e),n=this;t.collection("users").onSnapshot((function(e){n.updateUsers()}))}},{key:"startGame",value:function(){this.updatePhase("question")}},{key:"advanceQuestion",value:function(){var e=this.state.roomId;this.setState({questionNum:this.state.questionNum+1}),w.collection("Rooms").doc(e).update({date_index:this.state.questionNum})}},{key:"render",value:function(){var e=this,t=this.state,n=t.roomId,a=t.password,o=t.phase,c=t.authenticated,s=t.users,i=t.questionNum;this.updateGame,this.restartGame,this.endGame,this.quitGame;if("no"===c)return r.a.createElement("div",{className:"page-container host-page"},r.a.createElement(U.a,null,r.a.createElement(D.a,{label:"Game PIN",name:"Game ID",value:n,onChange:this.handleChange("roomId")})),r.a.createElement(U.a,null,r.a.createElement(D.a,{label:"Password",type:"password",name:"password",value:a,onChange:this.handleChange("password")})),r.a.createElement(L.a,{onClick:function(){return e.joinGame()},variant:"contained"},"Host"));if("yes"===c){if("connection"===o)return r.a.createElement("div",{className:"page-container host-page"},r.a.createElement("p",null," Users List "),r.a.createElement("ul",{id:"user-list"},s.map((function(e){return r.a.createElement("li",null,e.nickname)}))),r.a.createElement("button",{onClick:function(){return e.startGame()}},"start stonks game"));if("question"===o)return r.a.createElement("div",{className:"page-container host-page"},r.a.createElement("span",null,"Current question: ")," ",r.a.createElement("span",{className:"dynamic-text"},i),r.a.createElement("p",null," Users List "),r.a.createElement("ul",{id:"user-list"},s.map((function(e){return r.a.createElement("li",{key:e.id},e.nickname)}))),r.a.createElement("button",{onClick:function(){return e.advanceQuestion()}},"next question"))}}}]),n}(a.Component)),T=(a.Component,n(89),function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).handleChangeSelect=function(e){a.setState(Object(R.a)({},e.target.name,e.target.value))},a.handleChange=function(e){return function(t){a.setState(Object(R.a)({},e,t.target.value))}},a.state={gameId:null,password:"",userId:"",nickname:"",phase:"not-joined",questionNum:0,chartURLs:[],technicalIndicatorUrls:[],net_worth:0,cash:[],curShares:[],prices:[]},a.addUser=a.addUser.bind(Object(b.a)(a)),a.joinGame=a.joinGame.bind(Object(b.a)(a)),a.initGameListener=a.initGameListener.bind(Object(b.a)(a)),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){}},{key:"initGameListener",value:function(){var e=this,t=this.state,n=t.questionNum,a=t.gameId,r=t.phase;t.nickname;w.collection("Rooms").doc(a).onSnapshot((function(t){var a=t.data(),o=a.day_index,c=a.phase;console.log(a),n!=o&&e.setState({questionNum:o+1}),r!==c&&e.setState({phase:c})}))}},{key:"joinGame",value:function(){var e=this.state,t=e.gameId,n=e.password,a=e.nickname,r=this;w.collection("Rooms").doc(t).get().then((function(e){if(e.exists){var o=e.data();if(o.password===n&&"connection"===o.phase){var c=r.addUser(a,o.starting_money);r.setState({phase:"connection",userId:c,net_worth:o.starting_money,cash:o.starting_money}),r.initGameListener()}else o.password===n?console.log("game not being hosted yet"):"connection"===o.phase?console.log("incorrect password"):console.log("game does not exist")}else console.log("room "+t+" does not exist")}))}},{key:"render",value:function(){var e=this,t=this.state,n=(t.game,t.phase),a=t.password,o=t.nickname,c=(t.playerKey,t.questionNum),s=t.gameId;t.recentGameId,t.recentGame,t.isRedirected,t.gametype;return console.log(c),"not-joined"===n?r.a.createElement("div",{className:"page-container play-page"},r.a.createElement("div",null,r.a.createElement(U.a,null,r.a.createElement(D.a,{label:"Nickname",name:"nickname",value:o,onChange:this.handleChange("nickname")})),r.a.createElement(U.a,null,r.a.createElement(D.a,{label:"Game PIN",name:"Game ID",value:s,onChange:this.handleChange("gameId")})),r.a.createElement(U.a,null,r.a.createElement(D.a,{label:"Password",type:"password",name:"password",value:a,onChange:this.handleChange("password")})),r.a.createElement(L.a,{onClick:function(){return e.joinGame()},variant:"contained"},"Join"))):"connection"===n?r.a.createElement("div",null,r.a.createElement("p",null," Connected. Please wait for host to start game. ")):"question"===n?r.a.createElement("div",null,r.a.createElement("span",null,"Current question: ")," ",r.a.createElement("span",{className:"dynamic-text"},c),r.a.createElement("p",null," (question info will be displayed here) "),r.a.createElement("button",null," Buy "),r.a.createElement("button",null," Sell "),r.a.createElement("button",null," Hold ")):void 0}}]),n}(a.Component)),A=Object(a.createContext)({user:null}),B=(a.Component,function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={},a}return Object(i.a)(n,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement(m.a,null,r.a.createElement("title",null," toohak stonks quizzes ")),r.a.createElement("div",{id:"home"},r.a.createElement("section",null,r.a.createElement("div",null),r.a.createElement("h1",null,"toohak app"),r.a.createElement("div",{className:"play-button-container"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(d.b,{to:"/play"},"Play")))),r.a.createElement("div",{className:"host-button-container"},r.a.createElement("p",null,r.a.createElement(d.b,{to:"/host"},"Host a room"))),r.a.createElement("div",{className:"create-button-container"},r.a.createElement("p",null,r.a.createElement(d.b,{to:"/create"},"Create a room"))),r.a.createElement("div",{className:"auth-container"},r.a.createElement(d.b,{to:"/auth/signIn"},"Login"),r.a.createElement(d.b,{to:"/auth/signUp"},"Signup")))))}}]),n}(a.Component)),W=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={},a}return Object(i.a)(n,[{key:"render",value:function(){return r.a.createElement(d.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("div",{id:"content"},r.a.createElement(p.a,{exact:!0,path:"/play",render:function(){return r.a.createElement(T,null)}}),r.a.createElement(p.a,{exact:!0,path:"/host",render:function(){return r.a.createElement(_,null)}}),r.a.createElement(p.a,{exact:!0,path:"/create",render:function(){return r.a.createElement(M,null)}}),r.a.createElement(p.a,{exact:!0,path:"/",render:function(){return r.a.createElement(B,null)}}))))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(W,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[71,1,2]]]);
//# sourceMappingURL=main.659791a7.chunk.js.map